<div class="create-shipment-page">
  <div class="container">
    <div class="page-header">
      <h1><i class="fas fa-box"></i> Create a Shipment</h1>
      <p>Fill in the details below to create your shipment</p>
    </div>

    <div class="row">
      <div class="col-lg-8">
        <div class="shipment-form-card">
          <form [formGroup]="shipmentForm" (ngSubmit)="onSubmit()">
            <!-- Origin Section -->
            <div class="form-section">
              <h3><i class="fas fa-map-marker-alt"></i> Origin Information</h3>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label">Origin Country *</label>
                  <input type="text" 
                         class="form-control" 
                         formControlName="originCountry"
                         [class.is-invalid]="f['originCountry'].invalid && f['originCountry'].touched"
                         placeholder="e.g., Sierra Leone">
                  <div class="invalid-feedback" *ngIf="f['originCountry'].invalid && f['originCountry'].touched">
                    <span *ngIf="f['originCountry'].errors?.['required']">Origin country is required</span>
                    <span *ngIf="f['originCountry'].errors?.['minlength']">Minimum 2 characters required</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label">Origin Address *</label>
                  <input type="text" 
                         class="form-control" 
                         formControlName="originAddress"
                         [class.is-invalid]="f['originAddress'].invalid && f['originAddress'].touched"
                         placeholder="Full address">
                  <div class="invalid-feedback" *ngIf="f['originAddress'].invalid && f['originAddress'].touched">
                    <span *ngIf="f['originAddress'].errors?.['required']">Origin address is required</span>
                    <span *ngIf="f['originAddress'].errors?.['minlength']">Minimum 5 characters required</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Destination Section -->
            <div class="form-section">
              <h3><i class="fas fa-location-arrow"></i> Destination Information</h3>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label">Destination Country *</label>
                  <input type="text" 
                         class="form-control" 
                         formControlName="destinationCountry"
                         [class.is-invalid]="f['destinationCountry'].invalid && f['destinationCountry'].touched"
                         placeholder="e.g., United States">
                  <div class="invalid-feedback" *ngIf="f['destinationCountry'].invalid && f['destinationCountry'].touched">
                    <span *ngIf="f['destinationCountry'].errors?.['required']">Destination country is required</span>
                    <span *ngIf="f['destinationCountry'].errors?.['minlength']">Minimum 2 characters required</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label">Destination Address *</label>
                  <input type="text" 
                         class="form-control" 
                         formControlName="destinationAddress"
                         [class.is-invalid]="f['destinationAddress'].invalid && f['destinationAddress'].touched"
                         placeholder="Full address">
                  <div class="invalid-feedback" *ngIf="f['destinationAddress'].invalid && f['destinationAddress'].touched">
                    <span *ngIf="f['destinationAddress'].errors?.['required']">Destination address is required</span>
                    <span *ngIf="f['destinationAddress'].errors?.['minlength']">Minimum 5 characters required</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Package Details -->
            <div class="form-section">
              <h3><i class="fas fa-box-open"></i> Package Details</h3>
              <div class="row">
                <div class="col-md-4 mb-3">
                  <label class="form-label">Product Type *</label>
                  <select class="form-select" formControlName="productTypeId">
                    <option *ngFor="let type of productTypes" [value]="type.id">
                      {{ type.name }}
                    </option>
                  </select>
                </div>
                <div class="col-md-4 mb-3">
                  <label class="form-label">Weight (kg) *</label>
                  <input type="number" 
                         class="form-control" 
                         formControlName="weight"
                         [class.is-invalid]="f['weight'].invalid && f['weight'].touched"
                         placeholder="0.0" 
                         step="0.1">
                  <div class="invalid-feedback" *ngIf="f['weight'].invalid && f['weight'].touched">
                    <span *ngIf="f['weight'].errors?.['required']">Weight is required</span>
                    <span *ngIf="f['weight'].errors?.['min']">Minimum weight is 0.1 kg</span>
                    <span *ngIf="f['weight'].errors?.['max']">Maximum weight is 1000 kg</span>
                  </div>
                </div>
                <div class="col-md-4 mb-3">
                  <label class="form-label">Quantity *</label>
                  <input type="number" 
                         class="form-control" 
                         formControlName="quantity"
                         [class.is-invalid]="f['quantity'].invalid && f['quantity'].touched"
                         placeholder="1" 
                         min="1">
                  <div class="invalid-feedback" *ngIf="f['quantity'].invalid && f['quantity'].touched">
                    <span *ngIf="f['quantity'].errors?.['required']">Quantity is required</span>
                    <span *ngIf="f['quantity'].errors?.['min']">Minimum quantity is 1</span>
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Description (Optional)</label>
                <textarea class="form-control" 
                          formControlName="description" 
                          rows="3"
                          [class.is-invalid]="f['description'].invalid && f['description'].touched"
                          placeholder="Describe your shipment contents"></textarea>
                <div class="invalid-feedback" *ngIf="f['description'].invalid && f['description'].touched">
                  <span *ngIf="f['description'].errors?.['maxlength']">Maximum 500 characters allowed</span>
                </div>
              </div>
            </div>

            <div class="form-actions">
              <button type="button" class="btn btn-secondary" routerLink="/">
                <i class="fas fa-times"></i> Cancel
              </button>
              <button type="submit" class="btn btn-primary" [disabled]="shipmentForm.invalid">
                <i class="fas fa-check"></i> Create Shipment
              </button>
            </div>
          </form>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="estimate-card">
          <h3><i class="fas fa-calculator"></i> Estimated Cost</h3>
          <div class="estimate-amount">
            <span class="currency">SLL</span>
            <span class="amount">{{ calculateEstimate() }}</span>
          </div>
          <p class="estimate-note">
            <i class="fas fa-info-circle"></i> 
            This is an estimate. Final cost will be calculated based on actual weight and dimensions.
          </p>
          <div class="estimate-details">
            <div class="detail-row">
              <span>Base Rate:</span>
              <span>50,000 SLL/kg</span>
            </div>
            <div class="detail-row">
              <span>Weight:</span>
              <span>{{ f['weight'].value || 0 }} kg</span>
            </div>
            <div class="detail-row">
              <span>Quantity:</span>
              <span>{{ f['quantity'].value || 0 }}</span>
            </div>
          </div>
        </div>

        <div class="help-card">
          <h4><i class="fas fa-question-circle"></i> Need Help?</h4>
          <p>Contact our support team for assistance</p>
          <button class="btn btn-outline-primary btn-sm">
            <i class="fas fa-phone"></i> Call Support
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
